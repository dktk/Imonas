@page
@model Imonas.V9.Web.Pages.Cases.CreateModel
@{
    ViewData["Title"] = "Create Case";
}

<div class="page-title">Create Exception Case</div>
<div class="page-subtitle">Document and track reconciliation exceptions</div>

<div class="card">
    <div class="card-header">Case Details</div>
    <div class="card-body">
        <form method="post">
            <div class="grid grid-2 gap-3">
                <div class="form-group">
                    <label asp-for="Input.Title">Case Title</label>
                    <input asp-for="Input.Title" class="form-control" placeholder="Brief description of the issue" />
                    <span asp-validation-for="Input.Title" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Input.CaseNumber">Case Number</label>
                    <input asp-for="Input.CaseNumber" class="form-control" readonly style="background-color: var(--bg-hover);" />
                    <div style="font-size: 0.875rem; color: var(--text-muted); margin-top: 0.5rem;">
                        Auto-generated
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="Input.Description">Description</label>
                <textarea asp-for="Input.Description" class="form-control" rows="4" placeholder="Detailed description of the variance or issue..."></textarea>
                <span asp-validation-for="Input.Description" class="text-danger"></span>
            </div>

            <div class="grid grid-3 gap-3">
                <div class="form-group">
                    <label asp-for="Input.Severity">Severity</label>
                    <select asp-for="Input.Severity" class="form-control">
                        <option value="1">ðŸŸ¢ Low</option>
                        <option value="2" selected>ðŸŸ¡ Medium</option>
                        <option value="3">ðŸŸ  High</option>
                        <option value="4">ðŸ”´ Critical</option>
                    </select>
                </div>

                <div class="form-group">
                    <label asp-for="Input.VarianceType">Variance Type</label>
                    <select asp-for="Input.VarianceType" class="form-control">
                        <option value="1">Amount</option>
                        <option value="2">Date</option>
                        <option value="3">Currency</option>
                        <option value="4">Bank Fee</option>
                        <option value="5">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label asp-for="Input.VarianceAmount">Variance Amount (Optional)</label>
                    <input asp-for="Input.VarianceAmount" type="number" step="0.01" class="form-control" placeholder="0.00" />
                </div>
            </div>

            <div class="grid grid-2 gap-3">
                <div class="form-group">
                    <label asp-for="Input.AssignedTo">Assign To (Optional)</label>
                    <select asp-for="Input.AssignedTo" class="form-control">
                        <option value="">-- Unassigned --</option>
                        <option value="admin">Admin</option>
                        <option value="analyst">Analyst</option>
                    </select>
                </div>

                <div class="form-group">
                    <label asp-for="Input.DueDate">Due Date (Optional)</label>
                    <input asp-for="Input.DueDate" type="date" class="form-control" />
                </div>
            </div>

            <div class="form-group">
                <label asp-for="Input.LinkedTransactionId">Linked Transaction ID (Optional)</label>
                <input asp-for="Input.LinkedTransactionId" type="text" class="form-control" placeholder="Transaction UUID" />
                <div style="font-size: 0.875rem; color: var(--text-muted); margin-top: 0.5rem;">
                    Link this case to a specific transaction
                </div>
            </div>

            <div class="card" style="background-color: var(--bg-tertiary); margin-bottom: 1.5rem;">
                <div class="card-body">
                    <h4 style="font-size: 1rem; margin-bottom: 1rem;">Additional Information</h4>

                    <div class="form-group">
                        <label asp-for="Input.RootCauseCode">Root Cause Code (Optional)</label>
                        <select asp-for="Input.RootCauseCode" class="form-control">
                            <option value="">-- Select Root Cause --</option>
                            <option value="PSP_DELAY">PSP Processing Delay</option>
                            <option value="BANK_FEE">Unexpected Bank Fee</option>
                            <option value="FX_VARIANCE">FX Rate Variance</option>
                            <option value="DATA_QUALITY">Data Quality Issue</option>
                            <option value="MISSING_TXN">Missing Transaction</option>
                            <option value="DUPLICATE">Duplicate Transaction</option>
                            <option value="OTHER">Other</option>
                        </select>
                    </div>

                    <div class="form-group" style="margin-bottom: 0;">
                        <label asp-for="Input.InitialNotes">Initial Notes (Optional)</label>
                        <textarea asp-for="Input.InitialNotes" class="form-control" rows="3" placeholder="Any initial observations or investigation notes..."></textarea>
                    </div>
                </div>
            </div>

            @if (!string.IsNullOrEmpty(Model.ErrorMessage))
            {
                <div class="alert alert-danger">
                    @Model.ErrorMessage
                </div>
            }

            <div class="flex gap-2">
                <button type="submit" class="btn btn-primary">âœ“ Create Case</button>
                <a asp-page="Index" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
